\documentclass{article}

% Fonts
\usepackage{fontspec}

% General formatting
\usepackage[margin=1.3in, headheight=3ex, headsep=3ex]{geometry}
\usepackage{fancyhdr}
\usepackage{parskip}
\usepackage{amsmath}

% Colour
\usepackage[usenames,dvipsnames]{xcolor}

% Hyperlinks
\usepackage{url}
\usepackage{hyperref}

\usepackage{syntax}

% Course details
\newcommand{\longcoursename}{
    Student Taught Courses (StuCo): Shilling the Rust Programming Language
}

\newcommand{\shortcoursename}{STUCO: RUSTLANG}
\newcommand{\courselocation}{PH A18B}
\newcommand{\meetingstarttime}{18:40}
\newcommand{\meetingendtime}{19:30}
\newcommand{\meetingdays}{Wednesday}
\newcommand{\longsemester}{Fall 2022}
\newcommand{\shortsemester}{F22}
\newcommand{\academicyear}{2021-22}
\newcommand{\deptcode}{98}
\newcommand{\coursecode}{008}
\newcommand{\fullcoursecode}{\deptcode-\coursecode}

% Headers and Footers
\pagestyle{fancy}
\lhead{Pierce; Duvall}
\rhead{\fullcoursecode\ \shortsemester}

\begin{document}
\thispagestyle{empty}
\begin{center}
    \begin{minipage}{.85\textwidth}
        \centering
        {\huge {\fullcoursecode} Homework 1: PPM Parsing}

        \vspace{1em}

        \begin{tabular}{@{}rl@{}}
            Cooper Pierce & \href{mailto:cppierce@andrew.cmu.edu}{\texttt{cppierce@andrew.cmu.edu}} \\
            Jack Duvall & \href{mailto:jrduvall@andrew.cmu.edu}{\texttt{jrduvall@andrew.cmu.edu}} \\
        \end{tabular}

        \vspace{1em}

        \longsemester
    \end{minipage}
\end{center}

\section*{Overview}
The goal of assignment is to get you used to basic Rust constructs and syntax, filling out the core of a program that actually does something useful! We hope this will give you familiarity with Rust's development workflow and start to get you comfortable with using the language.

This assignment will have you write a basic parser for a simple image format known as PPM.

\section*{PPM Images}
PPM is a very simple image format, consisting of just:
\begin{itemize}
    \item A \href{https://en.wikipedia.org/wiki/List_of_file_signatures}{``magic number''} to distinguish it from other files
    \item The width and height of the image
    \item The maximum intensity value of
    \item Pixels as packed RGB pixel values, read sequentially row-by-row
        (i.e., row-major) from the top left of the image.
\end{itemize}

\url{http://ailab.eecs.wsu.edu/wise/P1/PPM.html} outlines the format; for simplicity, we'll summarize it again here. Note that we'll be using the binary format, where each pixel channel takes up exactly one byte.

\subsection*{PPM Grammar}

The grammar for PPM files is as follows:

\begin{verbatim}
<ppm>        ::= <magic-num>
                 (<comment> | <whitespace>)* <width>
                 (<comment> | <whitespace>)* <height>
                 (<comment> | <whitespace>)* <maxval>
                 \n <pixels>

<magic-num>  ::= P6\n

<whitespace> ::= \t | \n | \x0C | \r | ' ' (i.e., a literal space)
<comment>    ::= # [^\n]* \n

<width>      ::= [0-9]+
<height>     ::= [0-9]+
<maxval>     ::= [0-9]+

<pixels>     ::= [\x00-\xFF]*
\end{verbatim}

There is also an additional constraint that the number of bytes parsed for pixels shall be exactly \(3wh\) where \(w\) and \(h\) are the parsed width and height, respectively.

Some assistance with reading the table above, if you haven't seen BNF-like grammar specifications before:
\begin{itemize}
    \item nonterminals (a name for a class of actual character sequences) are surrounded by angle brackets and are defined by production rules given on the right of a \texttt{::=}.
    \item the \texttt{|} operator expresses that either the left, or the right side can be chosen (e.g., \texttt{<whitespace>} can match any single newline, tab, etc..).
    \item the \texttt{+} and \texttt{*} operators express that the object to the left can be repeated 1 or more times or 0 or more times, respectively.
    \item ranges in square brackets express choice between the characters comprising the range; or the complement, if the initial character is a caret.
\end{itemize}

\subsection*{PPM Image Example}
An example would probably help understand the above specification a bit better:
\begin{verbatim}
P6
# I'm a PPM file! You can tell by the magic header
3 3 # This first number is the width, and the second is the height
# This next number is the maximum intensity of each pixel
# Exporting as "raw" in GIMP always gives 255, which makes sense; this is the
# maximum value of a u8. After this maxval, we are only allowed a single newline
# before the pixels start. These pixels can be arbitrary bytes!
255
<<<<<<<<<aaaaaaaaa~~~~~~~~~
\end{verbatim}
Copy-pasting this text into a file ending with \texttt{.ppm} and opening it in a compatible image-viewing program should give a 3x3 (note that this means it may be quite small) image with 3 horizontal gray stripes.

\section*{What You Will Write}
You will be writing code that parses the metadata in the PPM header, up until the pixels.

TODO rest of this

\end{document}
